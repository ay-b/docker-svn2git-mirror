sudo: required

services:
  - docker

env:
  global:
    - DOCKER_REPONAME=svn2git-mirror
    - COMPOSE_VERSION=1.17.1
    - secure: Jh4Tdb0qHceEAhoRV3GRk1PP2Nl69T7+0nNWWyTN3Ik+IGJV5LPeEsQKhaDbdXyS7uMRYT1cYTz+SXUeNQEl2ZjIJ/mJdwuASuzo3/WyWDQmnd/uNr8r4WT9i31fpEiL8ONlZvkrU4VI7yW54S+wgigDIfUTHTrfZpuu5s9p3FcrOzdEjX0JrRU5INiilps8BOfwhJlpTQ43vTTD3Hyn2NmDYe9ZnWugzvXyrES3u6J5eGNIl12DMYu60imcQV4FEa+Api1/JymFiGdhj7s4iHigTFy7cSHubSXU+AV5zsujaTq1EjkVni/m12aVlUQ69za7eVlpaJ39reA1UniT23bJVPufD4WHkVm9eU+BcM5t8Au5g7lCTm16pR2JZwNE7oUjEd4nUogiZ9PsENaXTo7dGmcHq2TYOqPJSNQAOVPuwQFtvTLGBOip6mUTGTZxKx6/TJWoFhZBihOINeinPSYRSW45FLR09wZJdTb2NDyZcGAJPjioAH3SgJu7WX42HSlnuMXxZoK9kqcmfxraenZcwb9XkP7ijIW3xg1MqljpwzHX14gWOyURA+m40dJEHB/SRCdSXZw5YsDX8GVEUbfMp8Ps8x78ifOeWf7KiEKbQx3Jlkg3bXyv7YL1p5tabjacxa1JL4EOzsxEjjp+1fgTc87lleFDf9bx99kcxm4=
    - secure: DGOayQVTsgX8mO2vT0SdMp53uNJJ/znyVx90LmJZDRTxdWOZCsQfUTrkuM+gsBO4RV23ThPloc2kIC+s+NW+Z4vfZVK6XE2ZLRrelhbrz8AzUiV8Psh3Mc6vHKixl3FAYwTnQPxt7LcjAu+6z0+Hg073GEHFK1Mb8jtcgn40Bw6x2jnRnwrthwVauCIX9F1oCVahxyMC7lfifj0jxmnzQk8JBTYdTkvov7ok4GY9dAtx8RUKeWo5EBwvfThZZMPmxLfbz1VxySqGN2qnBXfKMphWtKeBRCBX4lcHMks9iFEQcQxriswV+rJg/f7mN17s5zxqbbVs96JKi5aHZa21hmWr9B5yODpTyJY6LNRxUDpXRAaS7OnLC79pPctIc8X5tMxUBnfqJkl+avrGe7AP/btJdAQswkqoX7NL+UzyAijvQ9do4MPUffEi7bB9vjHAyfhORmXn6z4jVKBUM+CLRNTou4S5uh9aTCMn4DjxXQx6NYQzaCxC1UqTvWmezi+udOnZ8hmlRGhcYl7Iv76o/glM+aXLSxJuWryrprLU/IeAlAufcP5cBdFxHqtmrWMAMsraamuVXUFtszCfsSVJ+zikICLt/+6Xlx+ISTEC6LyJMKv0UnDKZkcVk2d8WJ1u4Pklo+XQ/eZOV7eWEeCPYW/nvcy7qdQTuv/WEzDcaho=

before_install:
  - sudo apt-get update
  - sudo apt-get -y -o Dpkg::Options::="--force-confnew" install docker-ce
  - docker --version
  - curl -L https://github.com/docker/compose/releases/download/${COMPOSE_VERSION}/docker-compose-`uname -s`-`uname -m` > docker-compose
  - chmod +x docker-compose
  - sudo mv docker-compose /usr/local/bin

install:
  - docker build -t $DOCKER_REPONAME .
  - docker run -d --name $DOCKER_REPONAME $DOCKER_REPONAME

script:
  - docker ps | grep -q $DOCKER_REPONAME
  - docker exec -i -t $DOCKER_REPONAME git_pubkey ant-contrib
  - docker exec -i -t $DOCKER_REPONAME svn_authors ant-contrib

after_success:
  - if [ "$TRAVIS_BRANCH" == "master" ]; then
    docker login -u "$DOCKER_USERNAME" -p "$DOCKER_PASSWORD";
    docker push $DOCKER_REPO
    fi

notifications:
  slack:
    secure: Q5z9SE+a6BOfiJQpZbGrIloPayObtmEtKYDRwBYQwi5TJiCCt3G4RtvnBHy36DUL+CoNHxeHLCFU5cr2wW/Adu6TR9XoPgr08EIc9oqLiTrQONgDgwGqdk4NrqFLfg0UWVPgDLtfqE7nuAHGRdIeF9zHJX5Xe8xve3yhSsRY5FSoQv8ab0i1SKWSqFsV9JaQdSLyboeJRJv8p6RHt5ayxXY3gBh74qFbK7TGQcJhqhz0i+1CPIujFL6lp6sl8xI0cqx+mTf04mWjv+wovjjtl5c5aAKRhIC9ApT2AcvM8SZ0xxZ6TNsrwb9Wdc3QHH9fLUsDqKr5X+orHVJKQZ4e8i8SkloBDDLiiNRsArLpgzVRxrZ4NdFK+KRBFl26PkuN7k+2vdcpP0dtlKOdZy/ON0ENzt1vK2RGx4SUEGiD8y0VImElZ8doblTc41WKtPUmMn0zz20st/UUbH2vaoV4YpSWf6DbDBgNkCD2hoM8GiHAgnWHIkv1X+RQDXjep+OAfUPp7dEgNZ8e0J8muVbOAJuwevwHMj0Z+uqqnzvXKGgaFL4iq4K1hr9LHn3WM/wFQ9fNce4s3+Shbgi9mwk6sSsl2KDSLL2+0sUF7lkp8VZDQZ5+kLt/qOwRPS/eJvXOLtoyeJ9adZbSzl0weZ574G1mIBCImQCKJf15y+dih5o=
